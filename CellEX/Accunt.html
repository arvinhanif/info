<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>CellEX — Account</title>

  <!-- Minimal styles adapted from your styles.css to keep this page self-contained -->
  <style>
    :root{
      --bg:#ffffff; --muted:#475569; --accent:#0ea5a8; --accent-2:#2563eb;
      --radius:10px; --container:980px; --shadow-sm:0 8px 30px rgba(16,24,40,0.06);
      font-family:Inter, system-ui, -apple-system, "Segoe UI", Roboto, Arial, sans-serif;
    }
    *{box-sizing:border-box}
    body{margin:0;background:var(--bg);color:#08112b;font-size:15px;line-height:1.45;min-height:100vh;display:flex;align-items:center;justify-content:center;padding:24px}
    .shell{width:100%;max-width:var(--container);display:grid;grid-template-columns:1fr 1fr 1fr;gap:20px;align-items:start}
    .card{background:#fff;border-radius:12px;padding:20px;box-shadow:var(--shadow-sm);border:1px solid rgba(15,23,36,0.04)}
    .card h3{margin:0 0 8px;font-size:18px}
    .card p{margin:0 0 14px;color:var(--muted);font-size:14px}

    form{display:flex;flex-direction:column;gap:10px}
    label{font-size:13px;color:var(--muted);display:block}
    input[type="text"],input[type="email"],input[type="password"],input[type="tel"]{
      padding:10px;border-radius:8px;border:1px solid rgba(15,23,36,0.08);font-size:14px;width:100%;
    }
    .row{display:flex;gap:8px}
    button{background:var(--accent-2);color:#fff;border:0;padding:10px 12px;border-radius:8px;cursor:pointer}
    .btn-ghost{background:transparent;border:1px solid rgba(15,23,36,0.06);color:var(--muted);padding:10px;border-radius:8px;cursor:pointer}
    .muted{color:var(--muted);font-size:13px}
    .message{padding:10px;border-radius:8px;font-size:14px}
    .message.success{background:#ecfdf5;color:#064e3b;border:1px solid rgba(16,185,129,0.08)}
    .message.error{background:#fff1f2;color:#78191f;border:1px solid rgba(239,68,68,0.08)}
    .small{font-size:13px;color:var(--muted)}
    .link{color:var(--accent-2);cursor:pointer;text-decoration:underline}

    /* responsive */
    @media (max-width:980px){
      .shell{grid-template-columns:1fr 1fr}
    }
    @media (max-width:680px){
      .shell{grid-template-columns:1fr;gap:14px}
    }
  </style>
</head>
<body>
  <main class="shell" aria-label="Account management panels">

    <!-- Panel 1: Customer Login (Email or Phone + Password) -->
    <section class="card" aria-labelledby="customer-login-title">
      <h3 id="customer-login-title">Customer Login</h3>
      <p class="muted">Sign in with your Gmail or phone number and password.</p>

      <form id="login-form" autocomplete="on" novalidate>
        <div>
          <label for="login-identifier">Gmail or Phone number</label>
          <input id="login-identifier" name="identifier" type="text" inputmode="tel" placeholder="you@example.com or 017XXXXXXXX" required />
        </div>

        <div>
          <label for="login-password">Password</label>
          <input id="login-password" name="password" type="password" placeholder="Enter your password" required minlength="6" />
        </div>

        <div class="row" style="margin-top:6px">
          <button type="submit">Sign in</button>
          <button type="button" class="btn-ghost" id="to-signup">Sign up instead</button>
        </div>

        <div id="login-msg" aria-live="polite"></div>
      </form>

      <hr style="margin:14px 0;border:none;border-top:1px solid rgba(15,23,36,0.04)" />

      <p class="small">Don't have an account? Use the Sign up panel in the middle to create one.</p>
    </section>

    <!-- Panel 2: Sign Up -->
    <section class="card" aria-labelledby="signup-title">
      <h3 id="signup-title">Sign Up (Create account)</h3>
      <p class="muted">Create a new customer account using Gmail or phone number.</p>

      <form id="signup-form" autocomplete="on" novalidate>
        <div>
          <label for="signup-name">Full name</label>
          <input id="signup-name" name="name" type="text" placeholder="Your name" required />
        </div>

        <div>
          <label for="signup-identifier">Gmail or Phone number</label>
          <input id="signup-identifier" name="identifier" type="text" placeholder="you@example.com or 017XXXXXXXX" required />
        </div>

        <div>
          <label for="signup-password">Password</label>
          <input id="signup-password" name="password" type="password" placeholder="Choose a password (min 6 chars)" required minlength="6" />
        </div>

        <div class="row">
          <button type="submit">Create account</button>
          <button type="button" class="btn-ghost" id="clear-signup">Clear</button>
        </div>

        <div id="signup-msg" aria-live="polite"></div>
      </form>

      <hr style="margin:14px 0;border:none;border-top:1px solid rgba(15,23,36,0.04)" />

      <p class="small">By creating an account you agree to our terms. We store demo users locally for this page only.</p>
    </section>

    <!-- Panel 3: Admin Login -->
    <section class="card" aria-labelledby="admin-title">
      <h3 id="admin-title">Admin Login</h3>
      <p class="muted">Admin can sign in here. Demo admin credentials are provided below for testing.</p>

      <form id="admin-form" autocomplete="on" novalidate>
        <div>
          <label for="admin-email">Admin Email</label>
          <input id="admin-email" name="email" type="email" placeholder="admin@example.com" required />
        </div>

        <div>
          <label for="admin-password">Password</label>
          <input id="admin-password" name="password" type="password" placeholder="Admin password" required />
        </div>

        <div class="row" style="margin-top:6px">
          <button type="submit">Admin sign in</button>
        </div>

        <div id="admin-msg" aria-live="polite"></div>
      </form>

      <hr style="margin:14px 0;border:none;border-top:1px solid rgba(15,23,36,0.04)" />

      <p class="small"><strong>Demo admin</strong>: admin@example.com / <strong>Admin@123</strong></p>
    </section>

  </main>

  <!-- Script: client-side user store + auth flow (localStorage-based demo) -->
  <script>
    /* Data model (localStorage)
       - users stored as array under key "cellex_users"
       - each user: { id, name, identifier, passwordHash }
       - demo admin not stored here; admin check is separate and uses provided demo credential
       - This is a client-side demo only — DO NOT use in production
    */

    // Helpers
    const LS_KEY = 'cellex_users_v1';

    function readUsers(){
      try {
        const raw = localStorage.getItem(LS_KEY);
        return raw ? JSON.parse(raw) : [];
      } catch(e){
        return [];
      }
    }
    function writeUsers(users){
      localStorage.setItem(LS_KEY, JSON.stringify(users));
    }

    function normalizeIdentifier(id){
      return id.trim().toLowerCase();
    }

    // Very small "hash" demo (not secure). In prod use server-side hashing.
    function simpleHash(str){
      let h = 2166136261 >>> 0;
      for(let i=0;i<str.length;i++){
        h = Math.imul(h ^ str.charCodeAt(i), 16777619) >>> 0;
      }
      return ('00000000' + (h >>> 0).toString(16)).slice(-8);
    }

    // UI elements
    const loginForm = document.getElementById('login-form');
    const signupForm = document.getElementById('signup-form');
    const adminForm = document.getElementById('admin-form');

    const loginMsg = document.getElementById('login-msg');
    const signupMsg = document.getElementById('signup-msg');
    const adminMsg = document.getElementById('admin-msg');

    const toSignupBtn = document.getElementById('to-signup');
    const clearSignupBtn = document.getElementById('clear-signup');

    // Demo admin credentials
    const DEMO_ADMIN_EMAIL = 'admin@example.com';
    const DEMO_ADMIN_PASS = 'Admin@123';

    // Utility to show messages
    function showMessage(container, text, type='success'){
      container.innerHTML = '<div class="message '+(type==='error' ? 'error' : 'success')+'">'+text+'</div>';
      setTimeout(()=>{ if(container) container.innerHTML = ''; }, 5000);
    }

    // Signup flow
    signupForm.addEventListener('submit', function(e){
      e.preventDefault();
      const name = document.getElementById('signup-name').value.trim();
      const identifierRaw = document.getElementById('signup-identifier').value.trim();
      const password = document.getElementById('signup-password').value;

      if(!name || !identifierRaw || password.length < 6){
        showMessage(signupMsg, 'Please provide name, valid identifier, and password (min 6 chars).', 'error');
        return;
      }

      const identifier = normalizeIdentifier(identifierRaw);
      const users = readUsers();

      // check duplicate identifier (email or phone)
      if(users.some(u => u.identifier === identifier)){
        showMessage(signupMsg, 'An account with that email/phone already exists. Please sign in.', 'error');
        return;
      }

      const newUser = {
        id: Date.now().toString(36),
        name,
        identifier,
        passwordHash: simpleHash(password)
      };
      users.push(newUser);
      writeUsers(users);

      showMessage(signupMsg, 'Account created successfully. You can now sign in.');
      signupForm.reset();
    });

    clearSignupBtn.addEventListener('click', function(){
      signupForm.reset();
      signupMsg.innerHTML = '';
    });

    // Login flow (customer)
    loginForm.addEventListener('submit', function(e){
      e.preventDefault();
      const identifierRaw = document.getElementById('login-identifier').value.trim();
      const password = document.getElementById('login-password').value;

      if(!identifierRaw || !password){
        showMessage(loginMsg, 'Please enter email/phone and password.', 'error');
        return;
      }

      const identifier = normalizeIdentifier(identifierRaw);
      const users = readUsers();

      const found = users.find(u => u.identifier === identifier && u.passwordHash === simpleHash(password));
      if(found){
        // "logged in" (client-side demo)
        showMessage(loginMsg, 'Welcome back, ' + found.name + '! You are now logged in.');
        loginForm.reset();
        // demo: set session flag
        sessionStorage.setItem('cellex_session', JSON.stringify({ type:'customer', id: found.id, name: found.name }));
        return;
      }

      // Not found -> suggest sign up
      showMessage(loginMsg, 'Credentials not found. Please check your details or sign up.', 'error');
    });

    // Shortcut: show signup panel focus
    toSignupBtn.addEventListener('click', function(){
      document.getElementById('signup-name').focus();
    });

    // Admin login
    adminForm.addEventListener('submit', function(e){
      e.preventDefault();
      const email = (document.getElementById('admin-email').value || '').trim().toLowerCase();
      const pass = document.getElementById('admin-password').value || '';

      if(!email || !pass){
        showMessage(adminMsg, 'Enter admin email and password.', 'error');
        return;
      }

      // simple check against demo admin credentials
      if(email === DEMO_ADMIN_EMAIL && pass === DEMO_ADMIN_PASS){
        showMessage(adminMsg, 'Admin signed in successfully.');
        adminForm.reset();
        sessionStorage.setItem('cellex_session', JSON.stringify({ type:'admin', email: DEMO_ADMIN_EMAIL }));
        return;
      }

      showMessage(adminMsg, 'Invalid admin credentials.', 'error');
    });

    // Accessibility: allow Enter key on inputs to submit forms (native does this)
    // Small helper: prefill with a demo user if none exist (optional convenience)
    (function ensureDemoUser(){
      const users = readUsers();
      if(users.length === 0){
        const demo = {
          id: 'demo1',
          name: 'Demo User',
          identifier: 'demo@example.com',
          passwordHash: simpleHash('Demo@123')
        };
        users.push(demo);
        writeUsers(users);
      }
    })();

    // Expose a tiny API for debugging in console (optional)
    window._cellex = {
      readUsers, writeUsers, simpleHash, LS_KEY
    };
  </script>
</body>
</html>
